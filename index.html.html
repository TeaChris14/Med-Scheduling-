<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <title>Medication Timing Helper</title>

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>

    body {

      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;

      margin: 0;

      padding: 0;

      background: #f5f5f7;

      color: #111;

    }

    .app {

      max-width: 480px;

      margin: 0 auto;

      padding: 16px;

    }

    h1 {

      font-size: 1.2rem;

      margin-bottom: 8px;

    }

    .subtitle {

      font-size: 0.85rem;

      color: #555;

      margin-bottom: 16px;

    }

    .card {

      background: #fff;

      border-radius: 12px;

      padding: 16px;

      box-shadow: 0 1px 3px rgba(0,0,0,0.1);

      margin-bottom: 12px;

    }

    label {

      font-size: 0.85rem;

      font-weight: 600;

      display: block;

      margin-bottom: 4px;

    }

    select, input[type="time"] {

      width: 100%;

      padding: 8px 10px;

      font-size: 0.95rem;

      border-radius: 8px;

      border: 1px solid #ccc;

      box-sizing: border-box;

      margin-bottom: 12px;

      background: #fafafa;

    }

    .radio-group {

      display: flex;

      gap: 8px;

      margin-bottom: 12px;

    }

    .radio-pill {

      flex: 1;

      background: #eee;

      border-radius: 999px;

      text-align: center;

      padding: 8px;

      font-size: 0.9rem;

      cursor: pointer;

      user-select: none;

    }

    .radio-pill.active {

      background: #007aff;

      color: #fff;

      font-weight: 600;

    }

    button {

      width: 100%;

      padding: 10px;

      border-radius: 999px;

      border: none;

      background: #007aff;

      color: #fff;

      font-size: 1rem;

      font-weight: 600;

      cursor: pointer;

      margin-top: 4px;

    }

    button:active {

      opacity: 0.8;

    }

    .result {

      font-size: 0.95rem;

      line-height: 1.4;

    }

    .result-title {

      font-weight: 700;

      margin-bottom: 4px;

    }

    .result-main {

      font-size: 1.05rem;

      margin-bottom: 4px;

    }

    .badge {

      display: inline-block;

      padding: 2px 8px;

      border-radius: 999px;

      font-size: 0.75rem;

      background: #e5f2ff;

      color: #0052a3;

      margin-left: 4px;

    }

    .disclaimer {

      font-size: 0.75rem;

      color: #777;

      margin-top: 8px;

    }

    .small {

      font-size: 0.8rem;

    }

    ul.forecast {

      padding-left: 18px;

      margin: 4px 0 0 0;

      font-size: 0.9rem;

    }

  </style>

</head>

<body>

<div class="app">

  <h1>Medication Timing Helper</h1>

  <div class="subtitle">

    For nurse use with standardised dosing times.<br/>

    When ordered off-time, shift to the next standard slot after minimum interval.

  </div>

 

  <div class="card">

    <label>Route</label>

    <div class="radio-group" id="route-group">

      <div class="radio-pill active" data-value="IV">IV</div>

      <div class="radio-pill" data-value="PO">PO</div>

    </div>

 

    <label for="regimen-select">Frequency & Pattern</label>

    <select id="regimen-select"></select>

 

    <label for="order-time">Doctor order / last given time</label>

    <input id="order-time" type="time" value="08:00" />

 

    <button id="calc-btn">Calculate next standard dose</button>

  </div>

 

  <div class="card">

    <div class="result" id="result">

      <div class="result-title">Result will appear here.</div>

      <div class="small">Select route, regimen and time, then tap “Calculate”.</div>

    </div>

  </div>

 

  <div class="card">

    <div class="small">

      <strong>Standardised timings (summary)</strong><br/>

      OM: IV 7am / PO 8am (18h)<br/>

      BD: IV 7&20 / PO 8&20 or 8&14 (9h or 4h)<br/>

      TDS: 7/14/20 (IV) · 8/14/20 (PO) (4h)<br/>

      QDS / Q6H: 2/7/14/20 pattern (4h)<br/>

      Q8H: 0/7/16 (IV) · 0/8/16 (PO) (6h)<br/>

      Q12H: 7&20 (IV) · 8&20 (PO) (9h)<br/>

      Q24H: 7 or 20 (IV) · 8 or 20 (PO) (18h)<br/>

      EOD, Q48H: 7am/8am every 48h (36h min)

    </div>

    <div class="disclaimer">

      Educational aid only. Follow institutional policies and consult doctor/pharmacist when in doubt.

    </div>

  </div>

</div>

 

<script>

  // Regimens based on your MTRT chart

  const REGIMENS = {

    IV: [

      { id: "IV_OM",  freq: "OM",  label: "OM – 7am",                 minHours: 18, times: [7],           cycleHours: 24 },

      { id: "IV_BD1", freq: "BD",  label: "BD – 7am & 8pm",           minHours: 9,  times: [7,20],        cycleHours: 24 },

      { id: "IV_TDS", freq: "TDS", label: "TDS – 7am, 2pm, 8pm",      minHours: 4,  times: [7,14,20],     cycleHours: 24 },

      { id: "IV_QDS", freq: "QDS", label: "QDS – 2am, 7am, 2pm, 8pm", minHours: 4,  times: [2,7,14,20],   cycleHours: 24 },

      { id: "IV_Q6H", freq: "Q6H", label: "Q6H – 2am, 7am, 2pm, 8pm", minHours: 4,  times: [2,7,14,20],   cycleHours: 24 },

      { id: "IV_Q8H", freq: "Q8H", label: "Q8H – 12mn, 7am, 4pm",     minHours: 6,  times: [0,7,16],      cycleHours: 24 },

      { id: "IV_Q12", freq: "Q12H",label: "Q12H – 7am & 8pm",         minHours: 9,  times: [7,20],        cycleHours: 24 },

      { id: "IV_Q24", freq: "Q24H",label: "Q24H – 7am or 8pm",        minHours: 18, times: [7,20],        cycleHours: 24 },

      { id: "IV_EOD", freq: "EOD", label: "EOD – 7am alternate days", minHours: 36, times: [7],           cycleHours: 48 },

      { id: "IV_Q48", freq: "Q48H",label: "Q48H – 7am q48h",          minHours: 36, times: [7],           cycleHours: 48 }

    ],

    PO: [

      { id: "PO_OM",  freq: "OM",  label: "OM – 8am",                   minHours: 18, times: [8],           cycleHours: 24 },

      { id: "PO_BD1", freq: "BD",  label: "BD – 8am & 8pm",             minHours: 9,  times: [8,20],        cycleHours: 24 },

      { id: "PO_BD2", freq: "BD",  label: "BD – 8am & 2pm",             minHours: 4,  times: [8,14],        cycleHours: 24 },

      { id: "PO_TDS", freq: "TDS", label: "TDS – 8am, 2pm, 8pm",        minHours: 4,  times: [8,14,20],     cycleHours: 24 },

      { id: "PO_QDS", freq: "QDS", label: "QDS – 2am, 8am, 2pm, 8pm",   minHours: 4,  times: [2,8,14,20],   cycleHours: 24 },

      { id: "PO_Q6H", freq: "Q6H", label: "Q6H – 2am, 8am, 2pm, 8pm",   minHours: 4,  times: [2,8,14,20],   cycleHours: 24 },

      { id: "PO_Q8H", freq: "Q8H", label: "Q8H – 12mn, 8am, 4pm",       minHours: 6,  times: [0,8,16],      cycleHours: 24 },

      { id: "PO_Q12", freq: "Q12H",label: "Q12H – 8am & 8pm",           minHours: 9,  times: [8,20],        cycleHours: 24 },

      { id: "PO_Q24", freq: "Q24H",label: "Q24H – 8am or 8pm",          minHours: 18, times: [8,20],        cycleHours: 24 },

      { id: "PO_EOD", freq: "EOD", label: "EOD – 8am alternate days",   minHours: 36, times: [8],           cycleHours: 48 },

      { id: "PO_Q48", freq: "Q48H",label: "Q48H – 8am q48h",            minHours: 36, times: [8],           cycleHours: 48 }

    ]

  };

 

  const routeGroup = document.getElementById("route-group");

  const regimenSelect = document.getElementById("regimen-select");

  const orderTimeInput = document.getElementById("order-time");

  const resultDiv = document.getElementById("result");

  const calcBtn = document.getElementById("calc-btn");

 

  let currentRoute = "IV";

 

  function populateRegimens() {

    const list = REGIMENS[currentRoute];

    regimenSelect.innerHTML = "";

    list.forEach(r => {

      const opt = document.createElement("option");

      opt.value = r.id;

      opt.textContent = `[${r.freq}] ${r.label}`;

      regimenSelect.appendChild(opt);

    });

  }

 

  function timeToHours(timeStr) {

    if (!timeStr) return null;

    const [h, m] = timeStr.split(":").map(Number);

    return h + (m || 0) / 60;

  }

 

  function hoursToClock(h) {

    const hour24 = ((h % 24) + 24) % 24;

    const hh = Math.floor(hour24);

    const mm = Math.round((hour24 - hh) * 60);

    const mmAdj = (mm === 60) ? 0 : mm;

    const hhAdj = (mm === 60) ? (hh + 1) % 24 : hh;

    return `${hhAdj.toString().padStart(2,"0")}:${mmAdj.toString().padStart(2,"0")}`;

  }

 

  function dayLabelFromHour(h) {

    const day = Math.floor(h / 24);

    if (day === 0) return "Same day";

    if (day === 1) return "Next day";

    return `Day +${day}`;

  }

 

  function formatHourAsDayTime(h) {

    return `${dayLabelFromHour(h)} at ${hoursToClock(h)}`;

  }

 

  function calculateNextDose() {

    const list = REGIMENS[currentRoute];

    const reg = list.find(r => r.id === regimenSelect.value);

    const orderHours = timeToHours(orderTimeInput.value);

 

    if (!reg || orderHours == null || isNaN(orderHours)) {

      resultDiv.innerHTML = `

        <div class="result-title">Missing information</div>

        <div class="small">Please select route, regimen and a valid time.</div>`;

      return;

    }

 

    const earliest = orderHours + reg.minHours;

 

    // Generate candidate standard times across several cycles

    const candidates = [];

    const maxCycles = (reg.cycleHours === 48) ? 8 : 4; // cover up to a week+

    for (let cycle = 0; cycle <= maxCycles; cycle++) {

      const baseOffset = cycle * reg.cycleHours;

      reg.times.forEach(t => {

        candidates.push(t + baseOffset);

      });

    }

    candidates.sort((a,b) => a - b);

 

    // Filter for those after earliest allowed

    const valid = candidates.filter(t => t >= earliest);

    if (valid.length === 0) {

      resultDiv.innerHTML = `

        <div class="result-title">No timing found</div>

        <div class="small">Try another combination or check with pharmacist.</div>`;

      return;

    }

 

    // Take next 3 doses (forecast)

    const nextThree = valid.slice(0, 3);

 

    const mainNext = nextThree[0];

    const forecastList = nextThree.map((t, idx) => {

      return `<li>Dose ${idx + 1}: ${formatHourAsDayTime(t)}</li>`;

    }).join("");

 

    const summary = `

      <div class="result-title">Next standard dose</div>

      <div class="result-main">

        ${formatHourAsDayTime(mainNext)}

        <span class="badge">${reg.freq}</span>

      </div>

      <div class="small">

        Route: <strong>${currentRoute}</strong><br/>

        Pattern: <strong>${reg.label}</strong><br/>

        Order / last dose: <strong>${hoursToClock(orderHours)}</strong><br/>

        Minimum interval: <strong>${reg.minHours} h</strong><br/>

        Earliest allowed (order + min): <strong>${formatHourAsDayTime(earliest)}</strong><br/>

        Logic: give at the <strong>first standard time</strong> at or after earliest allowed,

        then resume normal schedule.

      </div>

      <br/>

      <div class="small"><strong>Next 3 standard doses (forecast):</strong></div>

      <ul class="forecast">

        ${forecastList}

      </ul>

    `;

 

    resultDiv.innerHTML = summary;

  }

 

  // Event listeners

  routeGroup.addEventListener("click", (e) => {

    const pill = e.target.closest(".radio-pill");

    if (!pill) return;

    routeGroup.querySelectorAll(".radio-pill").forEach(p => p.classList.remove("active"));

    pill.classList.add("active");

    currentRoute = pill.dataset.value;

    populateRegimens();

  });

 

  calcBtn.addEventListener("click", calculateNextDose);

 

  // Initial setup

  populateRegimens();

</script>

</body>

</html>

 